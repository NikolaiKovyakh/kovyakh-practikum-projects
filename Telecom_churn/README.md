## Прогноз оттока. Телеком

Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах. 

**Цель**: 
- Построить модель, которая умеет определять собирается ли клиент уходить или же остаётся.

**Данные:**
Данные состоят из файлов, полученных из разных источников:

- `contract_new.csv` — информация о договоре;
- `personal_new.csv` — персональные данные клиента;
- `internet_new.csv` — информация об интернет-услугах;
- `phone_new.csv` — информация об услугах телефонии.

Во всех файлах столбец `customerID` содержит код клиента.

Информация о договорах актуальна на 1 февраля 2020.


Необходимые библиотеки и их версии:
- *pandas* - версия 1.2.4 или новее
- *matplotlib* - версия 3.3.4 или новее
- *numpy* - версия 1.20.1 или новее
- *seaborn* - версия 0.11.1 или новее
- ydata_profiling
- *scikit-learn* - версия 1.2.2 или новее
- *catboost* - версия 1.0.3 или новее
- *optuna* - версия 3.1.1 или новее


**Выводы по проекту**:

**Лучшая модель:**
Результаты обучения на кросс-валидации с random_state=220523:
Catboost на данных без коррелирующих признаков: **ROC AUC = 0.9224.** <br> Optimized parameters: {'n_estimators': 1174, 'learning_rate': 0.19636, 'max_depth': 2, 'boosting_type': 'Plain', 'random_state': 220523, 'loss_function': 'Logloss', 'eval_metric': 'AUC', 'verbose': 100}


При тестировании лучшей модели на тестовой выборке, анализе важных признаков и проверке на адекватность выяснилось:  
1. Наиболее "важными" признаками оказались:
    - days_active = 70.006592
    - TotalCharges = 7.810387
    - MonthlyCharges = 7.041347
    - Type = 5.607294<br><br>
2. Метрики на тестовой выборке: 
    - **AUC ROC = 0.9339**
    - recall = 0.64
    - precision = 0.9362<br><br>

 - Из всех, кого модель классифицировала как ушедших (TP + FP = 188), найдено 176 (TP) действительно ушедших. 12 оставшихся классифицированы, как ушедшие по ошибке (FP).
 - Из всех, кто больше не абонент (TP + FN = 275), верно классифицировано 176. 99 ушедших классифицировано по ошибке как оставшиеся (FN)
